{"version":3,"sources":["product-page.js"],"names":["Vue","component","props","image","type","String","default","category","price","Number","title","description","stockLevel","sold_out","Boolean","productId","required","colorVariations","Array","sizes","hasVariants","data","chosenCount","isAddingToCart","addToCartSuccess","addToCartError","selectedColor","selectedSize","currentImage","watch","newImage","computed","random","Math","floor","uniqueColors","seen","Set","filter","v","color","has","add","availableSizesForColor","map","size","i","arr","indexOf","selectedVariant","find","effectiveStockLevel","stock","imageSrc","isLarge","thumb_2200","thumb_1280","full","imageSrcset","srcset","push","length","join","imageSizes","cartUrl","window","location","origin","showMainPrice","showMainStock","canSelectQuantity","methods","selectColor","colorVariant","selectSize","variant","isColorOutOfStock","every","isSizeOutOfStock","addToCart","cartData","product_id","variation_color","variation_color_name","color_name","variation_size","variant_id","response","$root","success","updateQuantity","finishCartOperation","error","previousResponse","updateData","quantity","updateCartQuantity","console","log","cartCount","calculateCartQuantity","cartQuantity","$forceUpdate","updateMenuCartDisplay","setTimeout","Object","values","reduce","sum","item","qty","parseInt","buyNow","href","mounted","template"],"mappings":"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","file":"product-page.min.js","sourcesContent":["Vue.component(\"productpage\", {\n    props: {\n        image: {\n            type: String,\n            default: ''\n        },\n        category: {\n            type: String,\n            default: ''\n        },\n        price: {\n            type: Number,\n            default: 0\n        },\n        title: {\n            type: String,\n            default: ''\n        },\n        description: {\n            type: String,\n            default: ''\n        },\n        stockLevel: {\n            type: Number,\n            default: 0\n        },\n        sold_out: {\n            type: Boolean,\n            default: false\n        },\n        productId: {\n            type: Number,\n            required: true\n        },\n        colorVariations: {\n            type: Array,\n            default: () => []\n        },\n        sizes: {\n            type: Array,\n            default: () => []\n        },\n        hasVariants: {\n            type: Boolean,\n            default: false\n        }\n    },\n    data() {\n        return {\n            chosenCount: 1,\n            isAddingToCart: false,\n            addToCartSuccess: false,\n            addToCartError: '',\n            selectedColor: null,\n            selectedSize: null,\n            currentImage: this.image\n        };\n    },\n\n    watch: {\n        image(newImage) {\n            if (!this.selectedColor) {\n                this.currentImage = newImage;\n            }\n        }\n    },\n\n    computed: {\n        random() {\n            return Math.floor(Math.random() * 2) + 1;\n        },\n        uniqueColors() {\n            // Get unique colors from variants\n            const seen = new Set();\n            return this.colorVariations.filter(v => {\n                if (!v.color || seen.has(v.color)) return false;\n                seen.add(v.color);\n                return true;\n            });\n        },\n        availableSizesForColor() {\n            if (!this.selectedColor) return [];\n            // Get all sizes for the selected color from variants\n            return this.colorVariations\n                .filter(v => v.color === this.selectedColor.color)\n                .map(v => v.size)\n                .filter((v, i, arr) => v && arr.indexOf(v) === i);\n        },\n        selectedVariant() {\n            if (!this.selectedColor || !this.selectedSize) return null;\n            return this.colorVariations.find(v => v.color === this.selectedColor.color && v.size === this.selectedSize);\n        },\n        effectiveStockLevel() {\n            if (this.hasVariants && this.selectedVariant) {\n                return this.selectedVariant.stock;\n            } else if (!this.hasVariants) {\n                return this.stockLevel;\n            }\n            return 0;\n        },\n        imageSrc() {\n            if (typeof this.image === 'string') {\n                return this.image || '';\n            }\n            if (this.image && typeof this.image === 'object') {\n                if (this.isLarge && this.image.thumb_2200) {\n                    return this.image.thumb_2200;\n                }\n                if (this.image.thumb_1280) {\n                    return this.image.thumb_1280;\n                }\n                if (this.image.full) {\n                    return this.image.full;\n                }\n            }\n            return '';\n        },\n        imageSrcset() {\n            if (typeof this.image === 'string') {\n                return null;\n            }\n            if (this.image && typeof this.image === 'object') {\n                const srcset = [];\n                if (this.image.thumb_1280) {\n                    srcset.push(`${this.image.thumb_1280} 1280w`);\n                }\n                if (this.image.thumb_2200 && this.image.thumb_2200 !== this.image.thumb_1280) {\n                    srcset.push(`${this.image.thumb_2200} 2200w`);\n                }\n                if (this.image.full && this.image.full !== this.image.thumb_1280 && this.image.full !== this.image.thumb_2200) {\n                    srcset.push(`${this.image.full} 1920w`);\n                }\n                return srcset.length ? srcset.join(', ') : null;\n            }\n            return null;\n        },\n        imageSizes() {\n            return '(max-width: 1280px) 1280px, 2200px';\n        },\n        cartUrl() {\n            return window.location.origin + '/?checkout=1';\n        },\n        showMainPrice() {\n            return !this.hasVariants;\n        },\n        showMainStock() {\n            return !this.hasVariants;\n        },\n        canSelectQuantity() {\n            if (this.hasVariants) {\n                return this.selectedVariant && this.selectedVariant.stock > 0;\n            } else {\n                return this.stockLevel > 0;\n            }\n        }\n    },\n    methods: {\n        selectColor(colorVariant) {\n            this.selectedColor = colorVariant;\n            this.currentImage = colorVariant.image;\n            this.selectedSize = null;\n            this.chosenCount = 1;\n        },\n        selectSize(size) {\n            if (!this.selectedColor) return;\n            const variant = this.colorVariations.find(v => v.color === this.selectedColor.color && v.size === size);\n            if (!variant || variant.stock <= 0) return;\n            this.selectedSize = size;\n            this.currentImage = variant.image;\n            this.chosenCount = 1;\n        },\n        isColorOutOfStock(color) {\n            // If all variants for this color are out of stock\n            return this.colorVariations.filter(v => v.color === color).every(v => v.stock <= 0);\n        },\n        isSizeOutOfStock(color, size) {\n            const variant = this.colorVariations.find(v => v.color === color && v.size === size);\n            return !variant || variant.stock <= 0;\n        },\n        async addToCart() {\n            if (this.isAddingToCart || this.effectiveStockLevel <= 0) {\n                return;\n            }\n\n            this.isAddingToCart = true;\n            this.addToCartSuccess = false;\n            this.addToCartError = '';\n\n            let cartData = {\n                product_id: this.productId\n            };\n\n            if (this.selectedColor) {\n                cartData.variation_color = this.selectedColor.color;\n                cartData.variation_color_name = this.selectedColor.color_name;\n            }\n            if (this.selectedSize) {\n                cartData.variation_size = this.selectedSize;\n            }\n            if (this.selectedVariant) {\n                cartData.variant_id = this.selectedVariant.color + '-' + this.selectedVariant.size;\n            }\n\n            try {\n                const response = await this.$root.addToCart(cartData);\n                if (response.success) {\n                    if (this.chosenCount > 1) {\n                        await this.updateQuantity(response);\n                    } else {\n                        this.finishCartOperation(response);\n                    }\n                } else {\n                    this.isAddingToCart = false;\n                    this.addToCartError = 'Failed to add to cart.';\n                }\n            } catch (error) {\n                this.isAddingToCart = false;\n                this.addToCartError = 'An error occurred: ' + error;\n            }\n        },\n        async updateQuantity(previousResponse) {\n            let updateData = {\n                product_id: this.productId,\n                quantity: this.chosenCount\n            };\n            if (this.selectedColor) {\n                updateData.variation_color = this.selectedColor.color;\n                updateData.variation_color_name = this.selectedColor.color_name;\n            }\n            if (this.selectedSize) {\n                updateData.variation_size = this.selectedSize;\n            }\n            if (this.selectedVariant) {\n                updateData.variant_id = this.selectedVariant.color + '-' + this.selectedVariant.size;\n            }\n            try {\n                const response = await this.$root.updateCartQuantity(updateData);\n                if (response.success) {\n                    this.finishCartOperation(response);\n                } else {\n                    this.finishCartOperation(previousResponse);\n                }\n            } catch (error) {\n                this.finishCartOperation(previousResponse);\n            }\n        },\n\n        finishCartOperation(response) {\n            this.isAddingToCart = false;\n            this.addToCartSuccess = true;\n\n            console.log('Finishing cart operation with response:', response); // Debug log\n\n            // Calculate total cart count\n            const cartCount = this.calculateCartQuantity(response.data);\n            console.log('Calculated cart count:', cartCount); // Debug log\n\n            // Update all cart count references\n            window.cartCount = cartCount;\n\n            // Update root Vue instance cartQuantity\n            if (this.$root) {\n                this.$root.cartQuantity = cartCount;\n\n                // Force reactivity update\n                this.$root.$forceUpdate();\n\n                // Call the menu update method if it exists\n                if (typeof this.$root.updateMenuCartDisplay === 'function') {\n                    this.$root.updateMenuCartDisplay();\n                }\n\n                console.log('Updated root cart quantity to:', this.$root.cartQuantity); // Debug log\n            }\n\n            // Reset success message after delay\n            setTimeout(() => {\n                this.addToCartSuccess = false;\n            }, 3000);\n        },\n\n        // Also update the calculateCartQuantity method in product-page.js to match:\n        calculateCartQuantity(cartData) {\n            if (!cartData) return 0;\n\n            console.log('Product page calculating cart quantity for:', cartData); // Debug log\n\n            // Handle different cart data structures - same logic as vue.js\n            return Object.values(cartData).reduce((sum, item) => {\n                let qty = 0;\n\n                if (typeof item === 'number') {\n                    qty = item;\n                } else if (typeof item === 'object' && item !== null) {\n                    // Handle object with quantity property\n                    qty = item.quantity || item.qty || 0;\n                } else if (typeof item === 'string') {\n                    qty = parseInt(item, 10) || 0;\n                }\n\n                return sum + qty;\n            }, 0);\n        },\n        buyNow() {\n            // First add to cart\n            if (this.isAddingToCart || this.effectiveStockLevel <= 0) {\n                return;\n            }\n\n            this.addToCart();\n\n            // Then redirect to checkout\n            setTimeout(() => {\n                if (this.addToCartSuccess) {\n                    window.location.href = this.cartUrl;\n                }\n            }, 800); // Slightly longer delay to ensure cart is updated\n        }\n    },\n    mounted() {\n\n        // Preselect first color and first available size\n        if (this.uniqueColors && this.uniqueColors.length > 0) {\n            this.selectColor(this.uniqueColors[0]);\n            // Preselect first available size for that color\n            const sizes = this.availableSizesForColor;\n            if (sizes && sizes.length > 0) {\n                this.selectSize(sizes[0]);\n            }\n        }\n    },\n    template: `\n        <div class=\" md:py-12 px-4 md:px-8 font-body\">\n            <div class=\"max-w-7xl mx-auto\">\n                <div class=\"flex flex-col md:flex-row gap-8 lg:gap-16\">\n                    <!-- Product Image Section -->\n                    <div class=\"md:w-1/2 relative group\">\n                        <div class=\"relative \"> \n                           \n                            <img class=\"rounded-lg z-40 relative mx-auto \" :src=\"currentImage\" :alt=\"title\" /> \n                        </div>\n                        \n                        <!-- Color Variations -->\n                        <div v-if=\"uniqueColors && uniqueColors.length > 0\" class=\"mt-4\">\n                            <h5 class=\"text-sm font-medium mb-2\">Color <span v-if=\"selectedColor\">: {{ selectedColor.color_name }}</span></h5>\n                            <div class=\"flex flex-wrap gap-2\">\n                                <div v-for=\"color in uniqueColors\" :key=\"color.color\"\n                                    @click=\"!isColorOutOfStock(color.color) && selectColor(color)\"\n                                    class=\"w-8 h-8 rounded-full cursor-pointer border-2 transition-all\"\n                                    :class=\"[\n                                        selectedColor && selectedColor.color === color.color ? 'border-zinc-800 scale-110' : 'border-transparent',\n                                        isColorOutOfStock(color.color) ? 'opacity-40 pointer-events-none cursor-not-allowed' : ''\n                                    ]\"\n                                    :style=\"{ backgroundColor: color.color }\">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- Product Details Section -->\n                    <div class=\"md:w-1/2 max-w-md\">\n                        <div class=\"flex flex-col gap-y-4\">\n                            <div>\n                                <h4 v-if=\"category\" class=\"text-sm text-yellow-500 font-light mb-4 opacity-50\">{{category}}</h4>\n                                <h1 class=\"text-3xl md:text-5xl font-heading mb-2 uppercase text-balance\"  v-html=\"title\"></h1>\n                                <span v-if=\"showMainPrice && price\" class=\"text-2xl font-bold block mb-4\">£{{ price }}</span>\n                                <div class=\"stock-status mb-4\" v-if=\"showMainStock\">\n                                    <span class=\"text-sm font-medium\" :class=\"effectiveStockLevel > 0 ? 'text-green-600' : 'text-red-600'\" v-html=\"effectiveStockLevel > 0 ? 'In stock - ' + effectiveStockLevel + ' available' : 'Out of stock'\"></span>\n                                </div>\n                                <div class=\"product-description prose text-balance mt-4 prose-md mb-6\" v-if=\"description\" v-html=\"description\"></div>\n                            </div>\n                            \n\n\n                            <!-- Sizes -->\n                            <div v-if=\"selectedColor && availableSizesForColor.length > 0\" class=\"mb-4\">\n                                <h5 class=\"text-sm font-medium mb-2\">Size</h5>\n                                <div class=\"flex flex-wrap gap-2\">\n                                    <button v-for=\"size in availableSizesForColor\" :key=\"size\"\n                                        v-if=\"colorVariations.find(v => v.color === selectedColor.color && v.size === size)\"\n                                        @click=\"!isSizeOutOfStock(selectedColor.color, size) && selectSize(size)\"\n                                        class=\"px-4 py-2 border rounded-sm transition-colors duration-200 capitalize\"\n                                        :class=\"[\n                                            selectedSize === size ? 'bg-black text-white border-black' : 'bg-white text-black hover:bg-zinc-100',\n                                            isSizeOutOfStock(selectedColor.color, size) ? 'opacity-40 pointer-events-none cursor-not-allowed' : ''\n                                        ]\">\n                                        {{ size }}\n                                    </button>\n                                </div>\n                            </div>\n\n                            <!-- Status messages -->\n                            <div v-if=\"addToCartSuccess\" class=\"text-green-600 py-2 px-4 bg-green-50 rounded-sm mb-4\">\n                                ✓ Added to cart successfully!\n                            </div>\n                            <div v-if=\"addToCartError\" class=\"text-red-600 py-2 px-4 bg-red-50 rounded-sm mb-4\">\n                                ✗ {{ addToCartError }}\n                            </div>\n                            \n                            <!-- Purchase Actions -->\n                            <div :class=\"['flex flex-col gap-y-4', canSelectQuantity ? '' : 'opacity-30 pointer-events-none']\">\n                                <div class=\"quantity-selector\">\n                                    <label class=\"block text-sm font-medium mb-2\">Quantity</label>\n                                    <div class=\"bg-white rounded-sm flex items-center justify-between border border-zinc-300 max-w-[140px]\">\n                                        <button @click=\"canSelectQuantity && chosenCount > 1 ? chosenCount-- : null\" class=\"text-lg w-10 h-10 flex items-center justify-center hover:bg-zinc-100\">-</button>\n                                        <span class=\"font-medium\">{{chosenCount}}</span>\n                                        <button @click=\"canSelectQuantity && chosenCount < effectiveStockLevel ? chosenCount++ : null\" class=\"text-lg w-10 h-10 flex items-center justify-center hover:bg-zinc-100\">+</button>\n                                    </div>\n                                </div>\n                                \n                                <div class=\"buttons-container flex flex-col sm:flex-row gap-3 w-full border\">\n                                    <button \n                                        @click=\"buyNow\" \n                                        class=\"duration-200 hover:bg-zinc-800 rounded-sm text-white text-center font-bold py-3 px-6 bg-black sm:flex-1\"\n                                        :disabled=\"isAddingToCart || !canSelectQuantity\">\n                                        {{ isAddingToCart ? 'Processing...' : 'Buy now' }}\n                                    </button>\n                                    <button \n                                        @click=\"addToCart\" \n                                        class=\"duration-200 hover:bg-zinc-500 rounded-sm text-white text-center font-bold py-3 px-6 bg-zinc-400 sm:flex-1\"\n                                        :disabled=\"isAddingToCart || !canSelectQuantity\">\n                                        {{ isAddingToCart ? 'Adding...' : 'Add to basket' }}\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `\n});"]}